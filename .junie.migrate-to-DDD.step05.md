# ðŸš€ Updated IoT Pilot Server DDD Structure - Step 5

## ðŸ”Œ Task 5: Phase 5 - Device Domain - Services & Repositories (5-7 days)

### ðŸŽ¯ Overview
This phase focuses on implementing the domain services and repositories for the Device domain. These components provide the core business logic and data access capabilities for managing IoT devices.

### ðŸ“‹ Tasks

#### Task 5.1: Implement Device Domain Services
- Implement DeviceCreator service
- Implement DeviceUpdater service
- Implement DeviceRemover service
- Implement SSHConnector service
- Implement MetricsCollector service
- Implement DeviceValidator service

#### Task 5.2: Create Device Domain Events
- Implement DeviceRegistered event
- Implement DeviceUpdated event
- Implement DeviceRemoved event
- Implement DeviceConnected event
- Implement DeviceDisconnected event
- Implement SSHSessionStarted event
- Implement SSHSessionEnded event
- Implement MetricsCollected event

#### Task 5.3: Implement Device Repositories
- Implement PrismaDeviceRepository
- Implement InMemoryDeviceRepository (for testing)
- Implement RedisDeviceCacheRepository

#### Task 5.4: Create Infrastructure Services
- Implement NodeSSHClient
- Implement TelegrafMetricsCollector
- Implement DockerStatsCollector
- Implement MQTTDeviceNotifier
- Implement WebSocketDeviceNotifier

#### Task 5.5: Create DTOs and Mappers
- Implement Device DTOs
- Implement DeviceMetrics DTOs
- Implement SSHCommand DTOs
- Implement DeviceRegistration DTOs
- Implement Device mappers
- Implement DeviceMetrics mappers
- Implement SSHSession mappers

#### Task 5.6: Write Tests for Services and Repositories
- Unit tests for domain services
- Unit tests for repositories
- Integration tests for infrastructure services
- Tests for DTOs and mappers

### âœ… Task 5.7: Phase 5 Validation
- Device domain services implemented
- Device domain events implemented
- Device repositories implemented
- Infrastructure services implemented
- DTOs and mappers created
- Tests for services and repositories passing
- All existing functionality still works